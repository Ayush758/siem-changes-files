(window["securityDashboards_bundle_jsonpfunction"]=window["securityDashboards_bundle_jsonpfunction"]||[]).push([[5],{281:function(module,exports,__webpack_require__){switch(window.__osdThemeTag__){case"v7dark":return __webpack_require__(282);case"v7light":return __webpack_require__(284);case"v8dark":return __webpack_require__(286);case"v8light":return __webpack_require__(288)}},282:function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(283);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},283:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.login-wrapper {\n  margin: 10% auto;\n  width: 350px;\n  padding: 1rem;\n  position: relative; }\n\n.btn-login {\n  width: 100%; }\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},284:function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(285);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},285:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.login-wrapper {\n  margin: 10% auto;\n  width: 350px;\n  padding: 1rem;\n  position: relative; }\n\n.btn-login {\n  width: 100%; }\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},286:function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(287);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},287:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.login-wrapper {\n  margin: 10% auto;\n  width: 350px;\n  padding: 1rem;\n  position: relative; }\n\n.btn-login {\n  width: 100%; }\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},288:function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(289);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},289:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.login-wrapper {\n  margin: 10% auto;\n  width: 350px;\n  padding: 1rem;\n  position: relative; }\n\n.btn-login {\n  width: 100%; }\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},423:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));var _index=__webpack_require__(281);var external_osdSharedDeps_React_=__webpack_require__(0);var external_osdSharedDeps_React_default=__webpack_require__.n(external_osdSharedDeps_React_);var external_osdSharedDeps_ReactDom_=__webpack_require__(9);var external_osdSharedDeps_ReactDom_default=__webpack_require__.n(external_osdSharedDeps_ReactDom_);var external_osdSharedDeps_ElasticEui_=__webpack_require__(1);var login_utils=__webpack_require__(66);var common=__webpack_require__(7);function redirect(serverBasePath){const urlParams=new URLSearchParams(window.location.search);let nextUrl=urlParams.get("nextUrl");if(!nextUrl||nextUrl.toLowerCase().includes("//")){nextUrl=serverBasePath+"/"}window.location.href=nextUrl+window.location.hash}function extractNextUrlFromWindowLocation(){const urlParams=new URLSearchParams(window.location.search);let nextUrl=urlParams.get("nextUrl");if(!nextUrl||nextUrl.toLowerCase().includes("//")){nextUrl=encodeURIComponent("/")}else{nextUrl=encodeURIComponent(nextUrl);const hash=window.location.hash||"";nextUrl+=hash}return"?nextUrl=".concat(nextUrl)}function LoginPage(props){const[username,setUsername]=external_osdSharedDeps_React_default.a.useState("");const[password,setPassword]=external_osdSharedDeps_React_default.a.useState("");const[loginFailed,setloginFailed]=Object(external_osdSharedDeps_React_["useState"])(false);const[loginError,setloginError]=Object(external_osdSharedDeps_React_["useState"])("");const[usernameValidationFailed,setUsernameValidationFailed]=Object(external_osdSharedDeps_React_["useState"])(false);const[passwordValidationFailed,setPasswordValidationFailed]=Object(external_osdSharedDeps_React_["useState"])(false);let errorLabel=null;if(loginFailed){errorLabel=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{id:"error",color:"danger",textAlign:"center"},external_osdSharedDeps_React_default.a.createElement("b",null,loginError))}const handleSubmit=async e=>{e.preventDefault();setloginFailed(false);setUsernameValidationFailed(false);setPasswordValidationFailed(false);if(username===""){setUsernameValidationFailed(true);return}if(password===""){setPasswordValidationFailed(true);return}try{await Object(login_utils["a"])(props.http,username,password);redirect(props.http.basePath.serverBasePath)}catch(error){console.log(error);setloginFailed(true);setloginError("Invalid username or password. Please try again.");return}};const renderLoginButton=(authType,loginEndPoint,buttonConfig)=>{const buttonId="".concat(authType,"_login_button");const loginEndPointWithPath="".concat(props.http.basePath.serverBasePath).concat(loginEndPoint);return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"submit","aria-label":buttonId,size:"s",type:"prime",className:buttonConfig.buttonstyle||"btn-login",href:loginEndPointWithPath,iconType:buttonConfig.showbrandimage?buttonConfig.brandimage:""},buttonConfig.buttonname))};const formOptions=options=>{let formBody=[];const formBodyOp=[];let authOpts=[];if(typeof options==="string"){if(options===""){authOpts.push(common["i"].BASIC)}else{authOpts.push(options.toLowerCase())}}else{if(options&&options.length===1&&options[0]===""){authOpts.push(common["i"].BASIC)}else{authOpts=[...options]}}for(let i=0;i<authOpts.length;i++){switch(authOpts[i].toLowerCase()){case common["i"].BASIC:{formBody.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"user-name","aria-label":"username_input",placeholder:"Username",prepend:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"user"}),onChange:e=>setUsername(e.target.value),value:username,isInvalid:usernameValidationFailed})));formBody.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:passwordValidationFailed},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"password","aria-label":"password_input",placeholder:"Password",prepend:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"lock"}),type:"password",onChange:e=>setPassword(e.target.value),value:password,isInvalid:usernameValidationFailed})));const buttonId="".concat(common["i"].BASIC,"_login_button");formBody.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFormRow"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"submit","aria-label":buttonId,fill:true,size:"s",type:"submit",className:props.config.ui.basicauth.login.buttonstyle||"btn-login",onClick:handleSubmit},"Login to EventShield 2.0")));if(authOpts.length>1){if(props.config.auth.anonymous_auth_enabled){const anonymousConfig=props.config.ui[common["i"].ANONYMOUS].login;formBody.push(renderLoginButton(common["i"].ANONYMOUS,common["a"],anonymousConfig))}formBody.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}));formBody.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiHorizontalRule"],{size:"full",margin:"xl"}));formBody.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}))}break}case common["i"].OPEN_ID:{const oidcConfig=props.config.ui[common["i"].OPEN_ID].login;formBodyOp.push(renderLoginButton(common["i"].OPEN_ID,common["p"],oidcConfig));break}case common["i"].SAML:{const samlConfig=props.config.ui[common["i"].SAML].login;const nextUrl=extractNextUrlFromWindowLocation();const samlAuthLoginUrl=common["t"]+nextUrl;formBodyOp.push(renderLoginButton(common["i"].SAML,samlAuthLoginUrl,samlConfig));break}default:{setloginFailed(true);setloginError("Authentication Type: ".concat(authOpts[i]," is not supported for multiple authentication."));break}}}formBody=formBody.concat(formBodyOp);return formBody};return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiListGroup"],{className:"login-wrapper"},props.config.ui.basicauth.login.showbrandimage&&external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiImage"],{size:"fullWidth",alt:"",url:props.config.ui.basicauth.login.brandimage||props.http.basePath.prepend("/ui/logos/wazuh_dashboard_login_mark.svg")}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"m",textAlign:"center"},props.config.ui.basicauth.login.title||""),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiText"],{size:"s",textAlign:"center"},props.config.ui.basicauth.login.subtitle||""),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiForm"],{component:"form"},formOptions(props.config.auth.type),errorLabel))}function renderApp(coreStart,params,config){external_osdSharedDeps_ReactDom_default.a.render(external_osdSharedDeps_React_default.a.createElement(LoginPage,{http:coreStart.http,chrome:coreStart.chrome,config:config}),params.element);return()=>external_osdSharedDeps_ReactDom_default.a.unmountComponentAtNode(params.element)}}}]);